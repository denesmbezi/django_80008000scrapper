{% extends 'jobs/base.html' %}

{% block title %}Scraped Job Listings{% endblock %}

{% block content %}
    <div class="stats">
        <h3>Total Jobs: {{ jobs|length }}</h3>
        <p>Latest scraping results from LinkedIn</p>
        
        <a href="http://localhost:8001/jobs" class="btn btn-success" target="_blank">
            üîÑ Scrape New Jobs
        </a>
        
        <a href="/debug-jobs/" class="btn btn-danger" target="_blank">
            üêõ Debug Jobs Data
        </a>
        
        <a href="/admin/" class="btn btn-primary" target="_blank">
            ‚öôÔ∏è Django Admin
        </a>
    </div>

    {% if jobs %}
        {% for job in jobs %}
            <div class="job-card">
                <div class="job-title">
                    {{ job.job_title }}
                </div>
                
                <div class="job-location">
                    üìç {{ job.location }}
                </div>
                
                <!-- Debug info -->
                <div class="debug-info">
                    <strong>Link Debug Info:</strong><br>
                    Length: {{ job.link_to_apply|length }} characters<br>
                    Exists: {% if job.link_to_apply %}‚úÖ Yes{% else %}‚ùå No{% endif %}<br>
                    Starts with https: {% if job.link_to_apply|slice:":8" == "https://" %}‚úÖ Yes{% else %}‚ùå No{% endif %}
                </div>
                
                {% if job.link_to_apply %}
                    <a href="{{ job.link_to_apply }}" class="job-link" target="_blank">
                        Apply Now ‚Üí
                    </a>
                    
                    <!-- Show the actual link for debugging -->
                    <a href="{{ job.link_to_apply }}" class="link-preview" target="_blank">
                        {{ job.link_to_apply|truncatechars:100 }}
                    </a>
                {% else %}
                    <span style="color: red; font-weight: bold;">‚ùå No link available</span>
                {% endif %}
                
                <div class="job-date">
                    Added: {{ job.created_at|date:"M d, Y H:i" }}
                </div>
            </div>
        {% endfor %}
    {% else %}
        <div class="no-jobs">
            <h3>No jobs found</h3>
            <p>Click "Scrape New Jobs" to fetch the latest listings from LinkedIn!</p>
        </div>
    {% endif %}
{% endblock %}